import{r as e,j as s,m as a,B as r,T as o,k as n,n as i,o as l,I as t,d,C as c}from"./mui-core-BpoTvZsj.js";import{V as m,b as x,c as p,d as u}from"./mui-icons-58CkGrMT.js";import{o as h,s as f,u as j}from"./form-CP-dV_Zb.js";import{a as b}from"./zod-C4BXO83R.js";import{a as g}from"./axiosPublic-hwsEuR-7.js";import{b as w,R as S,A as y,e as k,E as v}from"../index-DnYbmb9J.js";import{b as C}from"./vendor-47kkluUf.js";import"./http-Dos3PyFQ.js";const I=h({email:f().min(1,"El email es obligatorio.").email("El email debe ser un formato válido."),password1:f().min(8,"La contraseña debe tener al menos 8 caracteres.").max(128,"La contraseña no debe exceder los 128 caracteres.").regex(/[A-Z]/,"La contraseña debe contener al menos una mayúscula.").regex(/[a-z]/,"La contraseña debe contener al menos una minúscula.").regex(/[0-9]/,"La contraseña debe contener al menos un número."),password2:f().min(1,"Confirma tu contraseña."),nombre:f().min(1,"El nombre es obligatorio.").max(50,"El nombre es demasiado largo."),apellido:f().min(1,"El apellido es obligatorio.").max(50,"El apellido es demasiado largo.")}).refine(e=>e.password1===e.password2,{message:"Las contraseñas no coinciden.",path:["password2"]});function z(){const h=C(),[f,z]=e.useState(!1),[E,W]=e.useState(!1),[A,L]=e.useState(!1),{showToast:T}=w(),{register:R,handleSubmit:q,watch:D,formState:{errors:O}}=j({resolver:b(I),defaultValues:{email:"",password1:"",password2:"",nombre:"",apellido:""}}),M=D("password1",""),N=D("email",""),P=M.length>=8,V=/\d/.test(M),B=/[a-zA-Z]/.test(M),G=/[A-Z]/.test(M),Z=!N||!M||!M.toLowerCase().includes(N.split("@")[0].toLowerCase())&&!N.toLowerCase().includes(M.toLowerCase());return s.jsx(a,{component:"main",maxWidth:"sm",children:s.jsxs(r,{sx:{marginTop:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[s.jsx(o,{component:"h1",variant:"h5",gutterBottom:!0,children:"Regístrate en Skill Swap"}),s.jsxs(r,{component:"form",onSubmit:q(async e=>{z(!0);try{const s=(await g.post(y.REGISTRATION,{email:e.email,password1:e.password1,password2:e.password2,nombre:e.nombre,apellido:e.apellido})).data.key;localStorage.setItem("skillswap_token",s),h(S.HOME,{state:{registered:!0}})}catch(s){if(z(!1),s.response?.data){const e=k(s.response.data);T(e||v.unexpected,"error")}else s.request?T(v.network,"error"):T(s.message||v.unexpected,"error")}}),noValidate:!0,sx:{mt:1,width:"100%"},children:[s.jsx(o,{variant:"subtitle1",sx:{mt:2,mb:1},children:"Información Personal"}),s.jsx(n,{direction:"row",spacing:2,children:s.jsx(i,{required:!0,fullWidth:!0,label:"Nombre",...R("nombre"),error:!!O.nombre,helperText:O.nombre?.message})}),s.jsx(i,{required:!0,fullWidth:!0,margin:"normal",label:"Apellido",...R("apellido"),error:!!O.apellido,helperText:O.apellido?.message}),s.jsx(o,{variant:"subtitle1",sx:{mt:3,mb:1},children:"Credenciales"}),s.jsx(i,{required:!0,fullWidth:!0,margin:"normal",label:"Email",autoComplete:"email",...R("email"),error:!!O.email,helperText:O.email?.message}),s.jsx(i,{required:!0,fullWidth:!0,margin:"normal",label:"Contraseña",type:E?"text":"password",autoComplete:"new-password",...R("password1"),InputProps:{endAdornment:s.jsx(l,{position:"end",children:s.jsx(t,{"aria-label":"toggle password visibility",onClick:()=>W(!E),onMouseDown:e=>e.preventDefault(),edge:"end",children:E?s.jsx(m,{}):s.jsx(x,{})})})},error:!!O.password1,helperText:O.password1?.message}),M&&s.jsxs(r,{sx:{mt:1,mb:1,width:"100%",overflow:"hidden"},children:[s.jsx(o,{variant:"caption",color:"text.secondary",sx:{mb:.5,display:"block"},children:"Requisitos de contraseña:"}),s.jsxs(n,{spacing:.5,sx:{width:"100%"},children:[s.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:.5},children:[P?s.jsx(p,{sx:{fontSize:16,color:"success.main",flexShrink:0}}):s.jsx(u,{sx:{fontSize:16,color:"error.main",flexShrink:0}}),s.jsx(o,{variant:"caption",color:P?"success.main":"text.secondary",noWrap:!0,children:"Mínimo 8 caracteres"})]}),s.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:.5},children:[V?s.jsx(p,{sx:{fontSize:16,color:"success.main",flexShrink:0}}):s.jsx(u,{sx:{fontSize:16,color:"error.main",flexShrink:0}}),s.jsx(o,{variant:"caption",color:V?"success.main":"text.secondary",noWrap:!0,children:"Al menos un número"})]}),s.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:.5},children:[B?s.jsx(p,{sx:{fontSize:16,color:"success.main",flexShrink:0}}):s.jsx(u,{sx:{fontSize:16,color:"error.main",flexShrink:0}}),s.jsx(o,{variant:"caption",color:B?"success.main":"text.secondary",noWrap:!0,children:"Al menos una letra"})]}),s.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:.5},children:[G?s.jsx(p,{sx:{fontSize:16,color:"success.main",flexShrink:0}}):s.jsx(u,{sx:{fontSize:16,color:"error.main",flexShrink:0}}),s.jsx(o,{variant:"caption",color:G?"success.main":"text.secondary",noWrap:!0,children:"Al menos una mayúscula"})]}),s.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:.5},children:[Z?s.jsx(p,{sx:{fontSize:16,color:"success.main",flexShrink:0}}):s.jsx(u,{sx:{fontSize:16,color:"error.main",flexShrink:0}}),s.jsx(o,{variant:"caption",color:Z?"success.main":"text.secondary",sx:{wordBreak:"break-word"},children:"No debe ser similar al email"})]})]})]}),s.jsx(i,{required:!0,fullWidth:!0,margin:"normal",label:"Confirmar Contraseña",type:A?"text":"password",autoComplete:"new-password",...R("password2"),InputProps:{endAdornment:s.jsx(l,{position:"end",children:s.jsx(t,{"aria-label":"toggle password visibility",onClick:()=>L(!A),onMouseDown:e=>e.preventDefault(),edge:"end",children:A?s.jsx(m,{}):s.jsx(x,{})})})},error:!!O.password2,helperText:O.password2?.message}),s.jsx(d,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:1},disabled:f,children:f?s.jsx(c,{size:24,color:"inherit"}):"REGISTRARSE"}),s.jsxs(n,{spacing:1,sx:{mt:1},children:[s.jsx(d,{color:"secondary",onClick:()=>h(S.LOGIN),fullWidth:!0,children:"¿Ya tienes cuenta? Inicia sesión"}),s.jsx(d,{variant:"text",onClick:()=>h(S.ROOT),fullWidth:!0,children:"Volver a Inicio"})]})]})]})})}h({email:f().min(1,"El email es obligatorio.").email("El email debe ser un formato válido."),password:f().min(1,"La contraseña es obligatoria.")});export{z as default};
