import{R as e,r as s,j as r,p as a,q as i,k as t,s as o,B as n,T as l,t as c,x as d,d as x,C as h,m,y as p,S as u,A as j}from"./mui-core-CIRgtlGz.js";import{u as g}from"./useMatchRequests-YPXlIU3q.js";import{a as y,k as b,l as v}from"./mui-icons-BQP8OJas.js";import{R as f}from"../index-BM7OiNGa.js";import{b as k}from"./vendor-CoiQIOlL.js";import"./skillsCache-CzaKsmNf.js";import"./http-Dos3PyFQ.js";const w=e.memo(({request:e,onAccept:m,onReject:p,isProcessing:u})=>{const j=k(),{id:g,emisor:w={},creado_en:z}=e,{id:C,nombre:R="Usuario",apellido:q="",media:S,foto_perfil:A,habilidades_ofrecer:B=[],habilidades_aprender:W=[]}=w,_=S||A,I=s.useCallback(()=>{j(f.USUARIO_BY_ID(C))},[C,j]),D=s.useCallback(()=>{m(g)},[g,m]),P=s.useCallback(()=>{p(g)},[g,p]);return r.jsxs(a,{sx:{mb:2,"&:hover":{boxShadow:3,transform:"translateY(-2px)",transition:"all 0.2s"}},children:[r.jsx(i,{children:r.jsxs(t,{direction:"row",spacing:2,alignItems:"flex-start",children:[r.jsx(o,{src:_,alt:`${R} ${q}`,sx:{width:60,height:60},children:!_&&r.jsx(y,{})}),r.jsxs(n,{sx:{flex:1},children:[r.jsxs(l,{variant:"h6",gutterBottom:!0,children:[R," ",q]}),r.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:1.5},children:"Te ha enviado una solicitud de match"}),B.length>0&&r.jsxs(n,{sx:{mb:1},children:[r.jsx(l,{variant:"caption",color:"text.secondary",display:"block",children:"Puede enseñar:"}),r.jsxs(t,{direction:"row",spacing:.5,flexWrap:"wrap",useFlexGap:!0,children:[B.slice(0,3).map((e,s)=>r.jsx(c,{label:e.nombre||e,size:"small",color:"primary",variant:"outlined",sx:{mt:.5}},s)),B.length>3&&r.jsx(c,{label:"+"+(B.length-3),size:"small",variant:"outlined",sx:{mt:.5}})]})]}),W.length>0&&r.jsxs(n,{children:[r.jsx(l,{variant:"caption",color:"text.secondary",display:"block",children:"Quiere aprender:"}),r.jsxs(t,{direction:"row",spacing:.5,flexWrap:"wrap",useFlexGap:!0,children:[W.slice(0,3).map((e,s)=>r.jsx(c,{label:e.nombre||e,size:"small",color:"secondary",variant:"outlined",sx:{mt:.5}},s)),W.length>3&&r.jsx(c,{label:"+"+(W.length-3),size:"small",variant:"outlined",sx:{mt:.5}})]})]}),r.jsx(l,{variant:"caption",color:"text.secondary",display:"block",sx:{mt:1},children:new Date(z).toLocaleString("es-ES",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})}),r.jsxs(d,{sx:{justifyContent:"space-between",px:2,pb:2},children:[r.jsx(x,{size:"small",onClick:I,disabled:u,children:"Ver Perfil"}),r.jsxs(t,{direction:"row",spacing:1,children:[r.jsx(x,{variant:"outlined",color:"error",startIcon:u?r.jsx(h,{size:16}):r.jsx(b,{}),onClick:P,disabled:u,size:"small",children:"Rechazar"}),r.jsx(x,{variant:"contained",color:"success",startIcon:u?r.jsx(h,{size:16}):r.jsx(v,{}),onClick:D,disabled:u,size:"small",children:"Aceptar"})]})]})]})}),z=()=>{const{requests:s,loading:a,error:i,actionLoading:t,acceptRequest:o,rejectRequest:c}=g(),[d,x]=e.useState({open:!1,message:"",severity:"success"}),y=async e=>{const s=await o(e);s.success?x({open:!0,message:"¡Match aceptado! Ahora pueden chatear",severity:"success"}):x({open:!0,message:s.error||"Error al aceptar solicitud",severity:"error"})},b=async e=>{const s=await c(e);s.success?x({open:!0,message:"Solicitud rechazada",severity:"info"}):x({open:!0,message:s.error||"Error al rechazar solicitud",severity:"error"})};return a?r.jsx(n,{sx:{display:"flex",justifyContent:"center",py:12},children:r.jsx(h,{})}):i?r.jsx(m,{maxWidth:"md",sx:{py:4},children:r.jsx(p,{sx:{p:3,bgcolor:"error.light"},children:r.jsx(l,{color:"error.dark",variant:"h6",children:i})})}):r.jsxs(m,{maxWidth:"md",sx:{py:4},children:[r.jsx(l,{variant:"h4",gutterBottom:!0,fontWeight:"bold",children:"Notificaciones"}),r.jsxs(n,{sx:{mt:4},children:[r.jsxs(l,{variant:"h5",gutterBottom:!0,fontWeight:"600",children:["Solicitudes de Match (",s.length,")"]}),0===s.length?r.jsxs(p,{sx:{p:6,textAlign:"center",mt:3},children:[r.jsx(l,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No tienes solicitudes de match pendientes"}),r.jsx(l,{variant:"body2",color:"text.secondary",children:"Las nuevas solicitudes aparecerán aquí cuando alguien solicite un match."})]}):r.jsx(n,{sx:{mt:3,display:"flex",flexDirection:"column",gap:2},children:s.map(e=>r.jsx(w,{request:e,onAccept:y,onReject:b,isProcessing:t===e.id},e.id))})]}),r.jsx(u,{open:d.open,autoHideDuration:4e3,onClose:()=>x({...d,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:r.jsx(j,{onClose:()=>x({...d,open:!1}),severity:d.severity,sx:{width:"100%"},children:d.message})})]})};export{z as default};
